{"title":"Hexo进阶之vps搭建","slug":"Hexo进阶之vps搭建","date":"2018-03-17T09:49:45.000Z","updated":"2018-03-17T09:59:07.727Z","comments":true,"path":"api/articles/Hexo进阶之vps搭建.json","photos":[],"link":"","excerpt":"由于还是贫穷的原因，do服务器背不动wordpress的mysql，现在打算把hexo折腾上去。我另外建了一个hexo，用来搭建到vps上，不使用pages服务。本地部署博客如果你已经有了，可以跳过<br>没有的，请看我的这篇博客Hexo搭建教程，搭建起并关联git仓库即可。","covers":["http://p5n2a03cb.bkt.clouddn.com/static/images/hexo-vps/nginx.png"],"content":"<blockquote>\n<p>由于还是贫穷的原因，do服务器背不动wordpress的mysql，现在打算把hexo折腾上去。我另外建了一个hexo，用来搭建到vps上，不使用pages服务。</p>\n</blockquote>\n<h1 id=\"本地部署博客\"><a href=\"#本地部署博客\" class=\"headerlink\" title=\"本地部署博客\"></a>本地部署博客</h1><p>如果你已经有了，可以跳过<br>没有的，请看我的这篇博客<a href=\"https://www.ypc.world/#/posts/Hexo%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B\">Hexo搭建教程</a>，搭建起并关联git仓库即可。</p>\n<a id=\"more\"></a>\n<h1 id=\"服务器安装nginx\"><a href=\"#服务器安装nginx\" class=\"headerlink\" title=\"服务器安装nginx\"></a>服务器安装nginx</h1><p><a href=\"http://wiki.ubuntu.org.cn/Nginx#.E5.AE.89.E8.A3.85nginx\" target=\"_blank\" rel=\"noopener\">ubuntu官方wiki</a><br>安装nginx<br><code>sudo apt-get install nginx</code><br>我的nginx版本为<code>1.10.3 (Ubuntu)</code></p>\n<p>Ubuntu安装之后的文件结构大致为：<br>所有的配置文件都在<code>/etc/nginx</code>下，并且每个虚拟主机已经安排在了<code>/etc/nginx/sites-available</code>下<br>程序文件在<code>/usr/sbin/nginx</code><br>日志放在了<code>/var/log/nginx</code>中<br>并已经在<code>/etc/init.d/</code>下创建了启动脚本<code>nginx</code><br>默认的虚拟主机的目录设置在了<code>/var/www/nginx-default</code>(有的版本默认的虚拟主机的目录设置在了<code>/var/www</code>, 请参考<code>/etc/nginx/sites-available</code>里的配置)</p>\n<h1 id=\"启动nginx\"><a href=\"#启动nginx\" class=\"headerlink\" title=\"启动nginx\"></a>启动nginx</h1><p>输入<code>sudo service nginx start</code>，随后访问你的vps地址，就可以看到nginx的页面了！<br><img src=\"http://p5n2a03cb.bkt.clouddn.com/static/images/hexo-vps/nginx.png\"></p>\n<h1 id=\"配置nginx\"><a href=\"#配置nginx\" class=\"headerlink\" title=\"配置nginx\"></a>配置nginx</h1><p>Nginx默认的网站配置文件在<code>/etc/nginx/sites-available/</code>里，有一个软链接(ln -s)链接到了<code>/etc/nginx/sites-enabled/</code>里<br>我们就做最基础的配置，在默认的配置上改就行</p>\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\"><span class=\"token function\">cp</span> /etc/nginx/sites-available/default /etc/nginx/sites-available/hexo\n<span class=\"token function\">sudo</span> <span class=\"token function\">vi</span> /etc/nginx/sites-available/hexo\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>然后修改如下</p>\n<pre class=\"line-numbers language-yaml\"><code class=\"language-yaml\">server <span class=\"token punctuation\">{</span>\n    listen 80;\n    listen <span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span>80;\n\n    root /var/www/hexo;    <span class=\"token comment\" spellcheck=\"true\"># 网站存放路径 路径下包含index.html等一系列文件</span>\n    index index.html index.htm index.nginx<span class=\"token punctuation\">-</span>debian.html;\n\n    server_name www.example.com example.com *.example.com; <span class=\"token comment\" spellcheck=\"true\"># 配置域名</span>\n\n    location / <span class=\"token punctuation\">{</span>\n        try_files $uri $uri/ =404;\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>创建软链接：<br><code>sudo ln -s /etc/nginx/sites-available/hexo /etc/nginx/sites-enabled/hexo</code></p>\n<p>删除默认配置<br><code>sudo rm /etc/nginx/sites-enabled/default</code></p>\n<p>重启nginx<br><code>sudo systemctl restart nginx</code></p>\n<blockquote>\n<p>以下内容均参考自<a href=\"https://blog.peiyingchi.com/2017/03/20/deploy-hexo-blog-to-VPS/\" target=\"_blank\" rel=\"noopener\">Deploy Hexo Blog to VPS |部署Hexo博客到VPS</a></p>\n</blockquote>\n<h1 id=\"安装rsync\"><a href=\"#安装rsync\" class=\"headerlink\" title=\"安装rsync\"></a>安装rsync</h1><p>文章中还介绍了hook部署，不过我之前也用过，新手用起来还是有点坎坷，所以这次我打算试试rsync，刚好do自带resync。<br>服务器端安装（有的话就不用了）</p>\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\"><span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> <span class=\"token function\">rsync</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>本地安装</p>\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> hexo-deployer-rsync --save\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h1 id=\"配置rsync\"><a href=\"#配置rsync\" class=\"headerlink\" title=\"配置rsync\"></a>配置rsync</h1><p>编辑根目录下的<code>_config.yml</code>文件，修改<code>deploy</code></p>\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\">deploy:\n  type: <span class=\"token function\">rsync</span>\n  host: vps-ip  <span class=\"token comment\" spellcheck=\"true\"># 这里填写你VPS的IP地址，比如：138.23.23.23</span>\n  user: vps-user <span class=\"token comment\" spellcheck=\"true\"># 这里填写你登陆VPS所用的用户名，比如：root</span>\n  root: /usr/www/blog <span class=\"token comment\" spellcheck=\"true\"># 这里填写你在nginx中配置的文件路径</span>\n  port: 22 <span class=\"token comment\" spellcheck=\"true\"># SSH默认端口号，不需要修改</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h1 id=\"上传\"><a href=\"#上传\" class=\"headerlink\" title=\"上传\"></a>上传</h1><p>最后运行<code>hexo g -d</code>就可以啦！<br>访问你的域名或者ip就可以看到了</p>\n<h1 id=\"后记\"><a href=\"#后记\" class=\"headerlink\" title=\"后记\"></a>后记</h1><p>我在配置的过程中神奇的出现了各种refused情况，讲个笑话，我用服务器ping 127.0.0.1被refused了。<br>最后卡了我几个小时，一气之下重置了服务器（反正也没多少东西）,又来了一遍，一遍过。。。。。我日您</p>\n","categories":[{"name":"hexo","slug":"hexo","count":2,"path":"api/categories/hexo.json"}],"tags":[{"name":"hexo","slug":"hexo","count":2,"path":"api/tags/hexo.json"},{"name":"教程","slug":"教程","count":4,"path":"api/tags/教程.json"}]}