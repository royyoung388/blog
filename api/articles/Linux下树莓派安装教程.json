{"title":"Linux下树莓派安装教程","slug":"Linux下树莓派安装教程","date":"2018-03-16T17:03:37.000Z","updated":"2018-03-18T02:49:54.665Z","comments":true,"path":"api/articles/Linux下树莓派安装教程.json","photos":[],"link":"","excerpt":"继hexo被我玩坏之后，树莓派快被我玩坏了。本着相同的出发点，写下了这篇博客","covers":["http://p5n2a03cb.bkt.clouddn.com/static/images/pi-start/sdcard.png","http://p5n2a03cb.bkt.clouddn.com/static/images/pi-start/config-home.png"],"content":"<blockquote>\n<p>继hexo被我玩坏之后，树莓派快被我玩坏了。本着相同的出发点，写下了这篇博客</p>\n</blockquote>\n<a id=\"more\"></a>\n<h1 id=\"准备：\"><a href=\"#准备：\" class=\"headerlink\" title=\"准备：\"></a>准备：</h1><p>电脑（我是ubuntu系统），树莓派（我的3b）</p>\n<h1 id=\"sd卡格式化\"><a href=\"#sd卡格式化\" class=\"headerlink\" title=\"sd卡格式化\"></a>sd卡格式化</h1><p>说实话格式化还是win下省心，点几下就行。但是linux下需要下载<a href=\"https://gparted.org/download.php\" target=\"_blank\" rel=\"noopener\">gparted</a>。<br><img src=\"http://p5n2a03cb.bkt.clouddn.com/static/images/pi-start/sdcard.png\"><br>右上角找到你的sd卡，然后右键整个空间格式化为fat32格式</p>\n<h1 id=\"下载系统\"><a href=\"#下载系统\" class=\"headerlink\" title=\"下载系统\"></a>下载系统</h1><p><a href=\"https://www.raspberrypi.org/downloads/\" target=\"_blank\" rel=\"noopener\">下载地址</a><br>我下载的是raspian系统。贫穷的我没有显示器，也就用不到图形界面，所以下载的lite版。<br>然后解压，得到一个img文件</p>\n<h1 id=\"写入img\"><a href=\"#写入img\" class=\"headerlink\" title=\"写入img\"></a>写入img</h1><p>秉承Linu下命令行的优良传统，我将使用命令行写入。老规矩，先上<a href=\"https://www.raspberrypi.org/documentation/installation/installing-images/linux.md\" target=\"_blank\" rel=\"noopener\">官方文档</a></p>\n<h2 id=\"找到sd卡的名字\"><a href=\"#找到sd卡的名字\" class=\"headerlink\" title=\"找到sd卡的名字\"></a>找到sd卡的名字</h2><p>在插入sd卡前后输入<code>lsblk</code>来确定sd卡的名字。比如我这里是sdc</p>\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\">$ lsblk\nNAME   MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT\nsdb      8:16   0 119.2G  0 disk \n├─sdb5   8:21   0  20.3G  0 part /media/roy/软件\n└─sdb1   8:17   0  98.9G  0 part /media/roy/6B631D29557982D4\nsdc      8:32   1  29.7G  0 disk \n├─sdc2   8:34   1  29.7G  0 part /media/roy/rootfs\n└─sdc1   8:33   1  41.8M  0 part /media/roy/boot\nsda      8:0    0 465.8G  0 disk \n├─sda4   8:4    0   7.5G  0 part <span class=\"token punctuation\">[</span>SWAP<span class=\"token punctuation\">]</span>\n├─sda2   8:2    0 214.1G  0 part /media/roy/游戏和下载\n├─sda5   8:5    0  46.6G  0 part /\n├─sda3   8:3    0   285M  0 part /boot\n├─sda1   8:1    0  51.7G  0 part \n└─sda6   8:6    0 145.7G  0 part /home\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h2 id=\"卸载sd卡\"><a href=\"#卸载sd卡\" class=\"headerlink\" title=\"卸载sd卡\"></a>卸载sd卡</h2><p>用<code>umount</code>命令卸载sdc所有的分区。</p>\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\"><span class=\"token function\">umount</span> /dev/sdc1\n<span class=\"token function\">umount</span> /dev/sdc2\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<h2 id=\"写入img-1\"><a href=\"#写入img-1\" class=\"headerlink\" title=\"写入img\"></a>写入img</h2><p>进入img文件所在目录，输入一下命令<br><em>注意！！！这里of后面的名字千万不要写错了，dd会强行重写！！！如果你输入的系统盘，那是真的没办法了！！！</em></p>\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\"><span class=\"token comment\" spellcheck=\"true\"># bs是块大小，官方推荐4M，if后接img文件名，of后面接sd卡的名字，注意：没有数字！！！</span>\n<span class=\"token function\">dd</span> bs<span class=\"token operator\">=</span>4M if<span class=\"token operator\">=</span>2018-03-13-raspbian-stretch.img of<span class=\"token operator\">=</span>/dev/sdc conv<span class=\"token operator\">=</span>fsync\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>这里是没有进度的，而且时间还比较长，所有会有种假死的情况，不用担心，玩会手机就行了<br>然后输入<code>sync</code>即可</p>\n<blockquote>\n<p>我这里省略了官方文档中的检验步骤</p>\n</blockquote>\n<h1 id=\"开启ssh功能\"><a href=\"#开启ssh功能\" class=\"headerlink\" title=\"开启ssh功能\"></a>开启ssh功能</h1><p><em>如果sd卡没有挂载的话，将sd卡拔了重新插上，这是为了挂载sd卡，从而能对其中的文件进行读写</em><br>在<code>/boot</code>根目录下创建ssh文件夹。ssh默认是关闭的，但是有了这个文件夹会开启ssh功能</p>\n<h1 id=\"通过wifi连接\"><a href=\"#通过wifi连接\" class=\"headerlink\" title=\"通过wifi连接\"></a>通过wifi连接</h1><p>我试过用网线连接pi和电脑，然而那个方法没有成功。现在用的wifi，而且还省了网线，岂不美滋滋。</p>\n<h2 id=\"使用ubuntu开启热点\"><a href=\"#使用ubuntu开启热点\" class=\"headerlink\" title=\"使用ubuntu开启热点\"></a>使用ubuntu开启热点</h2><p>方法自行百度吧，挺简单的</p>\n<h2 id=\"修改文件\"><a href=\"#修改文件\" class=\"headerlink\" title=\"修改文件\"></a>修改文件</h2><p>在你的sd卡中，找到一个<code>/etc/wpa_supplicant</code>目录，然后修改其中的<code>wpa_supplicant.conf</code>文件，添加<code>network</code>信息，根据你的热点信息自行修改，如下</p>\n<pre><code>ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev\nupdate_config=1\nnetwork={\n        ssid=&quot;ssid&quot;\n        psk=&quot;pwd&quot;\n}\n</code></pre><h1 id=\"开机\"><a href=\"#开机\" class=\"headerlink\" title=\"开机\"></a>开机</h1><p>等等，先别急，先输入<code>arp -a</code>，后面有用哦～<br>ok，经过上面的步骤，终于能开机啦！装好你的sd卡，然后开启电源就行。有黄灯闪烁就代表没问题。如果有问题。。。。。。。。客官，文章从头了解一下？</p>\n<h1 id=\"ssh连接\"><a href=\"#ssh连接\" class=\"headerlink\" title=\"ssh连接\"></a>ssh连接</h1><p><a href=\"https://www.raspberrypi.org/documentation/remote-access/ssh/unix.md\" target=\"_blank\" rel=\"noopener\">官方文档</a><br>输入<code>arp -a</code>，对比之前的信息找到你的pi的ip地址。然后输入<code>ssh pi@&lt;ip&gt;</code>。如果你不知道，一个个试吧23333.<br>第一次连接可能要输入个<code>yes</code>，然后输入初始密码<code>raspberry</code>。<br>如果看到<code>pi@raspberrypi ~ $</code>，那么恭喜！你开启了新世界！！！</p>\n<h1 id=\"ssh免密功能\"><a href=\"#ssh免密功能\" class=\"headerlink\" title=\"ssh免密功能\"></a>ssh免密功能</h1><p><a href=\"https://www.raspberrypi.org/documentation/remote-access/ssh/passwordless.md\" target=\"_blank\" rel=\"noopener\">官方文档</a><br>每次登录都要密码多麻烦啊，还好ssh有不要密码的功能。<br>首先确保你有ssh密匙，如果有请对照官方文档生成密匙<br>如果你的pi没有.ssh目录，请运行</p>\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\"><span class=\"token function\">cd</span> ~\n<span class=\"token function\">install</span> -d -m 700 ~/.ssh\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>然后在本地命令行中运行</p>\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\"><span class=\"token function\">cat</span> ~/.ssh/id_rsa.pub <span class=\"token operator\">|</span> <span class=\"token function\">ssh</span> <span class=\"token operator\">&lt;</span>USERNAME<span class=\"token operator\">></span>@<span class=\"token operator\">&lt;</span>IP-ADDRESS<span class=\"token operator\">></span> <span class=\"token string\">'cat >> .ssh/authorized_keys'</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>作用是将本地的ssh公匙上传到pi中，需要输入一次密码。<br>然后再次<code>ssh pi@&lt;ip&gt;</code>就能直接登录啦！</p>\n<h1 id=\"基本设置\"><a href=\"#基本设置\" class=\"headerlink\" title=\"基本设置\"></a>基本设置</h1><h2 id=\"扩展文件系统\"><a href=\"#扩展文件系统\" class=\"headerlink\" title=\"扩展文件系统\"></a>扩展文件系统</h2><p>pi的文件系统并不是你给多少空间就用多少的，还需要设置一下<br>输入<code>sudo raspi-config</code>，进入设置<br><img src=\"http://p5n2a03cb.bkt.clouddn.com/static/images/pi-start/config-home.png\"><br>进入7 高级设置<br><img src=\"http://p5n2a03cb.bkt.clouddn.com/static/images/pi-start/config-advance.png\"><br>选择第一个扩展文件系统</p>\n<h2 id=\"修改密码\"><a href=\"#修改密码\" class=\"headerlink\" title=\"修改密码\"></a>修改密码</h2><p>选择第一个，然后按照提示输入密码就行</p>\n<h2 id=\"设置LOCALE和TimeZone\"><a href=\"#设置LOCALE和TimeZone\" class=\"headerlink\" title=\"设置LOCALE和TimeZone\"></a>设置LOCALE和TimeZone</h2><p>进入4，然后选择<code>Change locale</code><br>使用空格取消已经选择的选项。然后选择</p>\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\">en_GB.UTF-8.UTF-8\nzh_CN.UTF-8.UTF-8\nzh_CN.GBK.GBK\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p>按tab然后选择ok。之后会让你选择默认语言。想用中文，则选择<code>zh_CN.UTF-8.UTF-8</code>。我选择的是<code>en_GB.UTF-8.UTF-8</code>。</p>\n<p>随后选择<code>Change TimeZone</code>选项，选择<code>Asia</code>和<code>Shanghai</code>即可</p>\n<h2 id=\"修改键盘布局\"><a href=\"#修改键盘布局\" class=\"headerlink\" title=\"修改键盘布局\"></a>修改键盘布局</h2><p>这个我是看的网上的教程说要改，但是我选择修改键盘布局会跳回主界面。不过我的键盘好像都对，也就不管了。</p>\n<h2 id=\"wifi连接\"><a href=\"#wifi连接\" class=\"headerlink\" title=\"wifi连接\"></a>wifi连接</h2><p>就是修改我们之前提到的<code>/etc/wpa_supplicant/wpa_supplicant.conf</code>，然后添加<code>network</code>信息即可</p>\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\">network<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>\n        ssid<span class=\"token operator\">=</span><span class=\"token string\">\"ssid\"</span>\n        psk<span class=\"token operator\">=</span><span class=\"token string\">\"pwd\"</span>\n<span class=\"token punctuation\">}</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<h2 id=\"更换源\"><a href=\"#更换源\" class=\"headerlink\" title=\"更换源\"></a>更换源</h2><p><a href=\"http://www.raspbian.org/RaspbianMirrors\" target=\"_blank\" rel=\"noopener\">树莓派官方镜像源列表</a><br>我使用的清华大学的源。<br>编辑<code>/etc/apt/sources.list</code>文件，<code>sudo nano /etc/apt/sources.list</code>，修改为，其实就是改为最下面的两句</p>\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\"><span class=\"token comment\" spellcheck=\"true\">#deb http://mirrordirector.raspbian.org/raspbian/ stretch main contrib non-free rpi</span>\n<span class=\"token comment\" spellcheck=\"true\"># Uncomment line below then 'apt-get update' to enable 'apt-get source'</span>\n<span class=\"token comment\" spellcheck=\"true\">#deb-src http://archive.raspbian.org/raspbian/ stretch main contrib non-free rpi</span>\ndeb http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ stretch main contrib non-free rpi\ndeb-src http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ stretch main contrib non-free rpi\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>编辑<code>etc/apt/sources.list.d/raspi.list</code>文件，<code>sudo nano /etc/apt/sources.list.d/raspi.list</code>，同理，修改为`</p>\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\"><span class=\"token comment\" spellcheck=\"true\">#deb http://archive.raspberrypi.org/debian/ stretch main ui</span>\n<span class=\"token comment\" spellcheck=\"true\"># Uncomment line below then 'apt-get update' to enable 'apt-get source'</span>\n<span class=\"token comment\" spellcheck=\"true\">#deb-src http://archive.raspberrypi.org/debian/ stretch main ui</span>\ndeb http://mirror.tuna.tsinghua.edu.cn/raspberrypi/ stretch main ui\ndeb-src http://mirror.tuna.tsinghua.edu.cn/raspberrypi/ stretch main ui\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>然后运行</p>\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> apt update\n<span class=\"token function\">sudo</span> apt upgrade\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<h2 id=\"（可选）下载vim\"><a href=\"#（可选）下载vim\" class=\"headerlink\" title=\"（可选）下载vim\"></a>（可选）下载vim</h2><p>因为pi自带vi非常不好用，所以可以选择使用nano，或者使用vim</p>\n<pre class=\"line-numbers language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> apt <span class=\"token function\">install</span> vim\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h2 id=\"更新固件\"><a href=\"#更新固件\" class=\"headerlink\" title=\"更新固件\"></a>更新固件</h2><p><code>sudo rpi-update</code></p>\n<p>到此整个pi的基础配置就完成了！！！<br>完结撒花！！！</p>\n","categories":[{"name":"Raspberry","slug":"Raspberry","count":2,"path":"api/categories/Raspberry.json"}],"tags":[{"name":"教程","slug":"教程","count":4,"path":"api/tags/教程.json"},{"name":"Raspberry","slug":"Raspberry","count":2,"path":"api/tags/Raspberry.json"}]}